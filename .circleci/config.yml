version: 2
jobs:
  build:
    docker:
      - image: ubuntu:latest
    steps:
      - checkout
      - run:
          name: Install fish
          command: |
            apt-get --quiet update
            apt-get --quiet --yes install software-properties-common curl
            add-apt-repository --yes ppa:fish-shell/release-3
            apt-get --quiet --yes install fish
            fish --version
      - run:
          name: Install fisher
          shell: fish
          command: |
            curl -sLo ~/.config/fish/functions/fisher.fish --create-dirs git.io/fisher
            fisher version
      - run:
          name: Install dependencies
          shell: fish
          command: |
            fisher add < fishfile
            fisher ls
  test:
    docker:
      - image: ubuntu:latest
    steps:
      - checkout
      - run: fish -c "fishtape test/*.fish"
